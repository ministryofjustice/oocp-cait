{% from '../Costs/Costs.njk' import Costs with context %}
{% from '../CallToAction/CallToAction.njk' import CallToAction with context %}
{% import "components.njk" as govuk with context %}

{% macro Section(name, className='', content='', depth=2) %}
{% set gv_depth = {
  '2': 'gv-u-heading-xlarge',
  '3': 'gv-u-heading-small',
  '4': 'gv-u-heading-medium'
} %}
<section id="{{ name }}" class="moj-Section moj-Section--{{ depth }} {{ className }}" data-element-block="{{name}}">
<h{{depth}} class="moj-Section__heading moj-Section__heading--{{ depth }} {{ gv_depth[depth] }}{% if className %} {{ className }}__heading{% endif %}">{{ getFormattedProp(name, 'heading') | safe }}</h{{depth}}>
{% if content %}
{{ content }}
{% endif %}
{% if caller %}
{{ caller() }}
{% endif %}
{% set body = getFormattedBody(name, 'body') %}
{% if body %}
<div class="Section__content gv-s-prose">
{{ body | safe }}
</div>
{% endif %}
{% if depth < 5 %}
{% set subsections = getElementProp(name, 'elements') %}
{% if subsections.length %}
{% for subsection in subsections %}
{% set subsections = [] %}
{{ macros.control(subsection, depth=depth+1) }}
{% endfor %}
{% endif %}
{% endif %}
{{ Costs(name) }}
{{ CallToAction(name, modifier='section') }}
</section>
{% endmacro %}